# World Map SNS

---

## 【このアプリについて】<br/>

「World Map SNS」は、世界中の国の魅力や情報などを気軽に投稿・共有できる SNS です。<br/>

---

## 【アプリ作成背景】

国のタイに興味を持ち、Google 検索や他の SNS でどんな国なのか、どんな場所が有名なのかなどの情報を探していました。<br/>
しかし、自分が求めている情報をある程度見つけることはできましたが、情報が膨大過ぎるため、探すのに時間が掛かりました。<br/>
また、実際にその国に訪れたことがある人の生の声（感想）なども知りたいと思ったため、今回、国に特化した SNS 風の Web アプリを作成するに至りました。<br/>

---

## 【アプリURL及び動作確認方法】<br/>

本アプリは Vercel にデプロイ済みです。<br/>
以下のURLより実際の動作をご確認いただけます。<br/>

https://world-frontend.vercel.app/<br/>

---

## 【🎨 アプリデザイン（Figma）】<br/>

## ![デザイン画像](./frontend/public/sample/スクリーンショット%202025-04-18%200.28.58.png)

---

## 【機能一覧】<br/>

- 新規登録<br/>
- ログイン<br/>
- ログアウト<br/>
- Google ログイン<br/>
- 投稿機能<br/>
- 投稿編集（更新）<br/>
- 投稿削除<br/>
- 「いいね」機能<br/>
- 投稿したユーザーの情報表示<br/>
- ユーザーページ<br/>
- ユーザーコメント保存・編集<br/>
- ユーザーの投稿記事一覧表示機能<br/>
- 国の検索機能
- 「お知らせ」機能追加

---

## 【アプリ操作説明】<br/>

```
1.  「新規登録」または「ログイン（Googleログイン可能）」
※テストアカウント
  - メールアドレス：test6789@example.com
  - パスワード：testatd278

2.  ログイン後、Google Mapが表示されるため、自分が興味ある国などを選択してください。
※マウスポインタが国から外れて、海に焦点が当たってしまうことがあります。その際はページをリロードしてください。（修正予定）

3.  国を表示させることで、右側に「投稿一覧」ボタンが表示されます。

4.  「投稿一覧」の「投稿」ボタンから実際に投稿することができます。

5.  投稿は投稿タイトル・投稿内容・画像を入力することで投稿できます。
※投稿タイトル・投稿内容は必須、画像はなくても投稿可能
```

## 【アプリ操作デモ】<br/>

![アプリの操作デモ](/frontend/public/demo/output.gif)<br/>

> [!CAUTION]
> 現在、追加機能実装や UI 修正などを行なっているため、操作デモは古い動画となっています。<br/>
> 近々修正予定のため、ご了承ください。

---

## 【使用技術】 <br/>

| カテゴリ           | 使用技術                              |
| ------------------ | ------------------------------------- |
| **フロントエンド** | React, Next.js, TypeScript, Chakra UI |
| **外部 API**       | Google Map API                        |
| **バックエンド**   | Node.js, Prisma                       |
| **認証**           | Next-auth                             |
| **データベース**   | Supabase                              |
| **デプロイ**       | Vercel                                |

---

## 【データベース設計（テーブル定義）】<br/>

### 🧑‍💻 User テーブル<br/>

| カラム名 | 型   | 説明             |
| -------- | ---- | ---------------- |
| id       | int4 | 主キー           |
| name     | text | ユーザー名       |
| image    | text | アイコン画像 URL |
| email    | text | メールアドレス   |
| password | text | パスワード       |
| comment  | text | 自己紹介文       |

---

### 📝 Post テーブル<br/>

| カラム名    | 型        | 説明                      |
| ----------- | --------- | ------------------------- |
| id          | int4      | 主キー                    |
| title       | text      | 投稿タイトル              |
| content     | text      | 投稿内容                  |
| createdAt   | timestamp | 作成日時                  |
| countryName | text      | 国名                      |
| userId      | int4      | 投稿者（User の外部キー） |

---

### ❤️ Likes テーブル<br/>

| カラム名 | 型   | 説明                      |
| -------- | ---- | ------------------------- |
| id       | int4 | 主キー                    |
| userId   | int4 | 「いいね」したユーザー ID |
| postId   | int4 | 「いいね」された投稿 ID   |

---

### 🔗 テーブル間のリレーション<br/>

- **User 1 : N Post**  
  （1 人のユーザーが複数の投稿を持つ）

- **User 1 : N Likes**  
  （1 人のユーザーが複数の投稿にいいねできる）

- **Post 1 : N Likes**  
  （1 つの投稿に複数のいいねが付く）

---

## 【工夫した点】<br/>

[サイトのデザイン]

- 各国に焦点を当て、ズームした際、どこに「投稿一覧」を表示させるかや各投稿記事の見た目などにもこだわりました。<br/>

[投稿したユーザーの情報表示]

- 「投稿一覧」にて投稿したユーザーのアイコンをクリックし、表示することでそのユーザーの情報（プロフィール画像・コメント）がすぐに閲覧できるように工夫し、投稿したユーザーの人物像を直感的に把握できるようにしました。<br/>

---

## 【苦戦した点】<br/>

[いいね機能]<br/>

- 「いいね」のボタンをクリックするだけではなく、データベースに専用のテーブルを作成し、そこにユーザーと投稿を紐づけて実装していくということを知り、どうユーザーと投稿を紐づければいいか、これらを踏まえてどう実装すればいいかという点に苦戦しました。<br/>
- テーブル作成後は、「いいね」の取得・作成・削除ができる API をバックエンド側で作成し、専用のコンポーネントを作成、そこで fetch を使って、API と接続できるようコードを実装していきました。<br/>

[画像を含む投稿の作成]<br/>

- supabase storage を使用して、画像の投稿もできるようにしました。<br/>
  storage への画像の保存処理は zenn の記事や公式ドキュメントを参考に画像 URL を supabase の Post テーブルの(image カラム)へ保存するように実装しました。<br/>
  しかし、コンソールには画像 URL は取得できているのに、投稿一覧に画像自体が反映せず、どこが原因なのか調べるのに苦戦しました。
- 結果的にフロントエンド・バックエンドを分けてアプリを作成しており、バックエンド側はローカル環境でビルドして作成された dist ディレクトリを vercel にアップロードして動いているため、今回その手順を行っておらず、古い API で投稿機能が動いている状況でした。
- 上記を行うことで、画像の投稿を行った際にもきちんと投稿一覧に画像を反映させることができました。

---

## 【追加予定機能】<br/>

- [ ] 国ごとの情報表示（首都・人口など）<br/>
- [ ] アカウント削除機能<br/>
- [ ] 国ごとの投稿数表示<br/>
- [ ] ユーザーページの「投稿記事」の編集・削除機能追加<br/>
- [ ] お知らせの更新（管理者ユーザーのみ）<br/>
- [ ] 投稿編集時の画像の表示及び画像変更、削除機能追加<br/>
- [ ] 各国の時間表示

---

## 【追加済み機能】

- [x] 検索窓の追加<br/>
- [x] 画像の投稿もできるようにする<br/>
- [x] ユーザーページにて自分の過去の投稿を確認する機能<br/>
- [x] 「お知らせ」機能追加
- [x] プロフィールアイコン変更機能<br/>

---

## 【修正・改善予定】<br/>

- [ ] [トップページUI修正](https://github.com/y-u27/world/issues/27)
- [ ] [複数回ページリロードをした際にログインページへリダイレクトされてしまう仕様の修正（再ログインもできなくなっている点）](https://github.com/y-u27/world/issues/24)
- [ ] [投稿画像を投稿した時の幅調整](https://github.com/y-u27/world/issues/30)
- [ ] [検索機能強化](https://github.com/y-u27/world/issues/32)

---

## 【修正済み】<br/>

- [x] [お知らせ投稿日時の正確な表示](https://github.com/y-u27/world/issues/29)<br/>
- [x] 検索窓に入力した場合の国にズームするタイミング<br/>
- [x] 正確な投稿時刻の表示<br/>
- [x] 画像を投稿しない時の Input タグの空欄表示<br/>
- [x] ユーザーページにて実装した過去投稿の UI 修正<br/>
- [x] ユーザーページでのプロフィール画像をクリックした時のコメント表示<br/>
